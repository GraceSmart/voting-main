{"remainingRequest":"/Users/gracesmart/Desktop/voting-main/vote_client/node_modules/babel-loader/lib/index.js!/Users/gracesmart/Desktop/voting-main/vote_client/node_modules/eslint-loader/index.js??ref--13-0!/Users/gracesmart/Desktop/voting-main/vote_client/src/api.js","dependencies":[{"path":"/Users/gracesmart/Desktop/voting-main/vote_client/src/api.js","mtime":1610328960000},{"path":"/Users/gracesmart/Desktop/voting-main/vote_client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gracesmart/Desktop/voting-main/vote_client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/gracesmart/Desktop/voting-main/vote_client/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CnZhciBhcGkgPSB7CiAgYmFzZVVSTDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsCiAgaXNBdXRoZW50aWNhdGVkOiBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7CiAgICB2YXIgdXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXInKSk7CiAgICByZXR1cm4gdXNlciAhPSBudWxsOwogIH0sCiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgcmVxdWVzdE9wdGlvbnMgPSB7CiAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICB9LAogICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgICB9KQogICAgfTsKICAgIHJldHVybiBmZXRjaCgiIi5jb25jYXQodGhpcy5iYXNlVVJMLCAiL2xvZ2luIiksIHJlcXVlc3RPcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICBfdGhpcy5sb2dvdXQoKTsKCiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3BvbnNlLnN0YXR1c1RleHQpOwogICAgICB9CgogICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgfSkudGhlbihmdW5jdGlvbiAodXNlcikgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlcicsIEpTT04uc3RyaW5naWZ5KHVzZXIpKTsKICAgICAgcmV0dXJuICJVc2VyICIuY29uY2F0KHVzZXJuYW1lLCAiIGxvZ2dlZCBpbiIpOwogICAgfSk7CiAgfSwKICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dCgpIHsKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyJyk7CiAgfSwKICBhbGxvd2VkOiBmdW5jdGlvbiBhbGxvd2VkKCkgewogICAgdmFyIHVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyJykpOwoKICAgIGlmICh1c2VyID09PSBudWxsKSB7CiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnTm90IGxvZ2dlZCBpbi4nKTsKICAgIH0KCiAgICB2YXIgcmVxdWVzdE9wdGlvbnMgPSB7CiAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgIGhlYWRlcnM6IHsKICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICdBdXRob3JpemF0aW9uJzogIkJlYXJlciAiLmNvbmNhdCh1c2VyLmFjY2Vzc1Rva2VuKQogICAgICB9CiAgICB9OwogICAgcmV0dXJuIGZldGNoKCIiLmNvbmNhdCh0aGlzLmJhc2VVUkwsICIvYWxsb3dlZCIpLCByZXF1ZXN0T3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgIH0pOwogIH0sCiAgdm90ZTogZnVuY3Rpb24gdm90ZShvcHRpb24pIHsKICAgIHZhciB1c2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpKTsKCiAgICBpZiAodXNlciA9PT0gbnVsbCkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ05vdCBsb2dnZWQgaW4uJyk7CiAgICB9CgogICAgdmFyIHJlcXVlc3RPcHRpb25zID0gewogICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgaGVhZGVyczogewogICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAiQmVhcmVyICIuY29uY2F0KHVzZXIuYWNjZXNzVG9rZW4pCiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gZmV0Y2goIiIuY29uY2F0KHRoaXMuYmFzZVVSTCwgIi92b3Rlcy8iKS5jb25jYXQob3B0aW9uKSwgcmVxdWVzdE9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgICB9KTsKICB9LAogIHZvdGVzOiBmdW5jdGlvbiB2b3RlcygpIHsKICAgIHZhciB1c2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpKTsKCiAgICBpZiAodXNlciA9PT0gbnVsbCkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ05vdCBsb2dnZWQgaW4uJyk7CiAgICB9CgogICAgdmFyIHJlcXVlc3RPcHRpb25zID0gewogICAgICBtZXRob2Q6ICdHRVQnLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAnQXV0aG9yaXphdGlvbic6ICJCZWFyZXIgIi5jb25jYXQodXNlci5hY2Nlc3NUb2tlbikKICAgICAgfQogICAgfTsKICAgIHJldHVybiBmZXRjaCgiIi5jb25jYXQodGhpcy5iYXNlVVJMLCAiL3ZvdGVzIiksIHJlcXVlc3RPcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgfSk7CiAgfSwKICBjaG9pY2VzOiBmdW5jdGlvbiBjaG9pY2VzKCkgewogICAgdmFyIHVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyJykpOwoKICAgIGlmICh1c2VyID09PSBudWxsKSB7CiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnTm90IGxvZ2dlZCBpbi4nKTsKICAgIH0KCiAgICB2YXIgcmVxdWVzdE9wdGlvbnMgPSB7CiAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgIGhlYWRlcnM6IHsKICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICdBdXRob3JpemF0aW9uJzogIkJlYXJlciAiLmNvbmNhdCh1c2VyLmFjY2Vzc1Rva2VuKQogICAgICB9CiAgICB9OwogICAgcmV0dXJuIGZldGNoKCIiLmNvbmNhdCh0aGlzLmJhc2VVUkwsICIvY2hvaWNlcyIpLCByZXF1ZXN0T3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgYXBpOw=="},{"version":3,"sources":["/Users/gracesmart/Desktop/voting-main/vote_client/src/api.js"],"names":["api","baseURL","isAuthenticated","user","JSON","parse","localStorage","getItem","login","username","password","requestOptions","method","headers","body","stringify","fetch","then","response","status","logout","Promise","reject","statusText","json","setItem","removeItem","allowed","accessToken","vote","option","votes","choices"],"mappings":"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","sourcesContent":["const api = {\n\n    baseURL: 'http://localhost:3000',\n\n    isAuthenticated () {\n        const user = JSON.parse(localStorage.getItem('user'))\n        return (user != null)\n    },\n\n    login (username, password) {\n        const requestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ username, password })\n        }\n\n        return fetch(`${this.baseURL}/login`, requestOptions)\n        .then(response => {\n            if (response.status === 401) {\n                this.logout()\n                return Promise.reject(response.statusText)\n            }\n            return response.json()\n        })\n        .then(user => {\n            localStorage.setItem('user', JSON.stringify(user))\n            return `User ${username} logged in`\n        })\n    },\n\n    logout () {\n        localStorage.removeItem('user')\n    },\n\n    allowed () {\n        const user = JSON.parse(localStorage.getItem('user'))\n\n        if (user === null) {\n            return Promise.reject('Not logged in.')\n        }\n\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${user.accessToken}`\n            }\n        }\n        return fetch(`${this.baseURL}/allowed`, requestOptions)\n        .then(response => response.json())\n    },\n\n    vote (option) {\n        const user = JSON.parse(localStorage.getItem('user'))\n\n        if (user === null) {\n            return Promise.reject('Not logged in.')\n        }\n        const requestOptions = {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${user.accessToken}`\n            }\n        }\n        return fetch(`${this.baseURL}/votes/${option}`, requestOptions)\n        .then(response => response.json())\n    },\n\n    votes () {\n        const user = JSON.parse(localStorage.getItem('user'))\n\n        if (user === null) {\n            return Promise.reject('Not logged in.')\n        }\n\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${user.accessToken}`\n            }\n        }\n        return fetch(`${this.baseURL}/votes`, requestOptions)\n        .then(response => response.json())\n    },\n\n    choices () {\n        const user = JSON.parse(localStorage.getItem('user'))\n\n        if (user === null) {\n            return Promise.reject('Not logged in.')\n        }\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${user.accessToken}`\n            }\n        }\n        return fetch(`${this.baseURL}/choices`, requestOptions)\n        .then(response => response.json())\n    }\n\n}\n\nexport default api"]}]}